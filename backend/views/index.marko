<!DOCTYPE html>

<!--
TrialInfo
https://github.com/trialinfo/trialinfo

Copyright 2012-2017  Andreas Grünbacher  <andreas.gruenbacher@gmail.com>
Lizenz: AGPLv3, http://www.gnu.org/licenses/agpl-3.0.html
-->

<html>
  <head>
    <title>ÖTSV Veranstaltungen 2017</title>
    <link rel="stylesheet" type="text/css" href="admin.css" />
    <style>
    a { text-decoration:none }
    </style>
    <script src="js/remaining-time.js"></script>
    <script>
      function start_timers() {
	var usec;

	Array.from(document.getElementsByClassName('timer')).forEach(function(timer) {
	  var timestamp = timer.getAttribute('timestamp');
	  if (!timestamp)
	    return;
	  usec = (new Date(timestamp)).getTime() - Date.now();
	  var id = timer.getAttribute('for');
	  var text = document.getElementById(id);
	  if (usec > 0) {
	    text.innerHTML = remaining_time(timestamp);
	  } else {
	    text.remove();
	    timer.remove();
	  }
	});
	if (usec)
	  setTimeout(start_timers, usec % 1000 + 100);
      }
    </script>

    <macro show_serie(serie, ignore)>
    <p>
      <for(event in data.events(serie))>
	<if(event.registration_ends)>
	  <span class="timer" timestamp="${event.registration_ends}" for="timer${event.id}">
	    <span style="color:red">${event.title} ${data.abbreviations(event.series, ignore=ignore)}</span><br>
	    &emsp;<a href="register/event/${event.id}" >Jetzt voranmelden</a>
	    (noch <span id="timer${event.id}">${data.remaining_time(event.registration_ends)}</span>)<br>
	  </span>
	</if>
	<else>
	  <a href="ergebnisse/tageswertung.shtml?id=${event.id}">${event.title}</a> ${data.abbreviations(event.series, ignore=ignore)}<br>
	</else>
      </for>
    </p>
    </macro>

  </head>
  <body onload="start_timers()">
    <h1>ÖTSV Veranstaltungen 2017</h1>
    <h2><a href="ergebnisse/jahreswertung.shtml?vareihe=32&spalte=lbl&spalte=fahrzeug">ÖTSV Cup</a> und <a href="ergebnisse/jahreswertung.shtml?vareihe=35&spalte=lbl&spalte=fahrzeug">Jugendcup</a>, <a href="ergebnisse/jahreswertung.shtml?vareihe=33&spalte=lbl&spalte=fahrzeug">AMF Staatsmeisterschaft</a></h2>
    <show_serie serie=32 ignore=[31]/>
    <h2><a href="ergebnisse/jahreswertung.shtml?vareihe=30&spalte=lbl">ÖTSV Kids e-Cup</a></h2>
    <show_serie serie=30 ignore=[30,31]/>
    <h2><a href="ergebnisse/jahreswertung.shtml?vareihe=34&spalte=lbl">ÖTSV Bike Trial Cup</a></h2>
    <show_serie serie=34 ignore=[31,34]/>
    <h2><a href="http://www.a-trial.info/a-cup/">A-Cup</a></h2>
    <h2>Sonstiges</h2>
    <p>
      <a href="ergebnisse/statistik.shtml?vareihe=31&kuerzel">Punktestatistiken</a><br>
      Ergebnisse <a href="ergebnisse/2016.shtml">2016</a>,
      <a href="ergebnisse/2015.shtml">2015</a>,
      <a href="ergebnisse/2014.shtml">2014</a>,
      <a href="ergebnisse/2013.shtml">2013</a>,
      <a href="ergebnisse/2012.shtml">2012</a>
    </p>
  </body>
</html>
