<!DOCTYPE html>

<!--
Trial-Auswertung
https://github.com/andreas-gruenbacher/trial-auswertung

Copyright 2012-2014  Andreas GrÃ¼nbacher  <andreas.gruenbacher@gmail.com>
Lizenz: AGPLv3, http://www.gnu.org/licenses/agpl-3.0.html
-->

<html ng-app='application'>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title ng-bind="$root.titel">Trial-Auswertung</title>
    <style type="text/css">
      *
      {
      font-family:"Trebuchet MS", Arial, Helvetica, sans-serif;
      }

      span.accesskey { text-decoration:underline; }
      .einzelpunkte { text-align:center; }
      .punktespalte { width:2em; }
      /*.adw { font-style:italic; }*/

      input[type=number]::-webkit-inner-spin-button,
      input[type=number]::-webkit-outer-spin-button {
	-webkit-appearance: none;
	margin: 0;
      }
      input, textarea, select, button { font-family:inherit; font-size:inherit; }

      textarea.ng-invalid.ng-dirty, input.ng-invalid.ng-dirty {
	color: #e00000;
	background-color: #fff0f0;
      }

      @media print {
	.no-print, .no-print * { display:none !important; }
	.page-break { page-break-before:always; }
      }
    </style>

    <script src="../js/angular.js"></script>
    <script src="../js/angular-route.js"></script>
    <script src="../js/validate.js"></script>
    <script src="directives.js"></script>
    <script src="api.js"></script>
    <script src="main/controller.js"></script>
    <script src="veranstaltung/controller.js"></script>
    <script src="nennungen/controller.js"></script>
    <script src="punkte/controller.js"></script>
    <script src="einstellungen/controller.js"></script>
    <script src="sektionen/controller.js"></script>
    <script src="veranstaltung/auswertung/controller.js"></script>
    <script src="veranstaltung/liste/controller.js"></script>
    <script src="vareihe/controller.js"></script>
    <script>

      var HAVE_WEASYPRINT;
<!--#if expr="$HAVE_WEASYPRINT = 1" -->
      HAVE_WEASYPRINT = true;
<!--#endif -->

      var application = angular.module('application', ['ngRoute', 'ui.validate']);

      application.directive('isoDate', isoDateDirective);
      application.directive('isoTime', isoTimeDirective);
      application.directive('isoTimestamp', isoTimestampDirective);
      application.directive('numeric', numericDirective);
      application.directive('punkte', punkteDirective);
      application.directive('yesNoNull', yesNoNullDirective);
      application.directive('wertungsklasse', wertungsklasseDirective);
      application.directive('nullable', nullableDirective);

      application.directive('autofocus', autofocusDirective);
      application.directive('tabTo', tabTo);

      application.controller('mainController', mainController);
      application.controller('veranstaltungController', veranstaltungController);
      application.controller('nennungenController', nennungenController);
      application.controller('einstellungenController', einstellungenController);
      application.controller('sektionenController', sektionenController);
      application.controller('veranstaltungAuswertungController', veranstaltungAuswertungController);
      application.controller('veranstaltungListeController', veranstaltungListeController);
      application.controller('vareiheController', vareiheController);

      application.config(function($routeProvider) {
	$routeProvider.
	  when('/', {
	    titel: 'Trial-Auswertung',
	    controller: 'mainController',
	    templateUrl: 'main/index.html',
	    resolve: mainController.resolve
	  }).when('/veranstaltung/:id', {
	    controller: 'veranstaltungController',
	    templateUrl: 'veranstaltung/index.html',
	    resolve: veranstaltungController.resolve
	  }).when('/veranstaltung/:id/nennungen', {
	    titel: 'Nennungen',
	    controller: 'nennungenController',
	    templateUrl: 'nennungen/index.html',
	    resolve: nennungenController.resolve,
	    reloadOnSearch: false
	  }).when('/veranstaltung/:id/punkte', {
	    titel: 'Punktevergabe',
	    controller: 'punkteController',
	    templateUrl: 'punkte/index.html',
	    resolve: punkteController.resolve,
	    reloadOnSearch: false
	  }).when('/veranstaltung/neu/einstellungen', {
	    controller: 'einstellungenController',
	    templateUrl: 'einstellungen/index.html',
	    resolve: einstellungenController.resolve
	  }).when('/veranstaltung/:id/einstellungen', {
	    titel: 'Einstellungen',
	    controller: 'einstellungenController',
	    templateUrl: 'einstellungen/index.html',
	    resolve: einstellungenController.resolve
	  }).when('/veranstaltung/:id/sektionen', {
	    titel: 'Sektionen aus der Wertung',
	    controller: 'sektionenController',
	    templateUrl: 'sektionen/index.html',
	    resolve: sektionenController.resolve
	  }).when('/veranstaltung/:id/auswertung', {
	    titel: 'Auswertung',
	    controller: veranstaltungAuswertungController,
	    templateUrl: 'veranstaltung/auswertung/index.html',
	    resolve: veranstaltungAuswertungController.resolve,
	    reloadOnSearch: false
	  }).when('/veranstaltung/:id/liste', {
	    titel: 'Fahrerliste',
	    controller: veranstaltungListeController,
	    templateUrl: 'veranstaltung/liste/index.html',
	    resolve: veranstaltungListeController.resolve,
	    reloadOnSearch: false
	  }).when('/vareihe/neu', {
	    controller: 'vareiheController',
	    templateUrl: 'vareihe/index.html',
	    resolve: vareiheController.resolve
	  }).when('/vareihe/:vareihe', {
	    controller: 'vareiheController',
	    templateUrl: 'vareihe/index.html',
	    resolve: vareiheController.resolve
	  }).otherwise({
	    redirectTo: '/'
	  });
      }).run(function($rootScope, $route) {
	$rootScope.kontext = function(kontext) {
	  var titel = [kontext];
	  if ($route.current.titel)
	    titel.push($route.current.titel);
	  $rootScope.titel = titel.join(' - ');
	};

	$rootScope.$on("$routeChangeSuccess", function() {
	  $rootScope.titel = $route.current.titel || '';
	});
      });
    </script>
  </head>
  <body ng-view>
  </body>
</html>
