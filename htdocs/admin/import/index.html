<h1>Import</h1>
<form name="form">
  <table>
    <tbody>
      <tr>
	<th align="right"><label for="operation">Aktion</label></th>
	<td>
	  <select ng-model="settings.operation" id="operation" ng-disabled="busy">
	    <option value="import-remote" ng-if="SYNC_SOURCE">Server-Import</option>
	    <option value="sync" ng-if="SYNC_SOURCE">Synchronisieren</option>
	    <option value="import-file">Datei-Import</option>
	  </select>
	</td>
      </tr>
      <tr ng-if="settings.operation != 'import-remote' && settings.operation != 'import-file'">
	<th align="right"><label for="tag">Veranstaltung</label></th>
	<td>
	  <select ng-model="settings.event" ng-options="event as veranstaltung_bezeichnung(event) for event in events" id="tag">
	  </select>
	</td>
      </tr>
      <tr ng-if="settings.operation == 'import-file'">
	<th align="right"><label for="format">Format</label></th>
	<td>
	  <select ng-model="settings.format" id="format" ng-disabled="busy">
	    <option value="trialinfo">TrialInfo</option>
	    <option value="trialtool">TrialTool</option>
	  </select>
	</td>
      </tr>
    </tbody>
    <tbody ng-if="settings.operation == 'import-remote'">
      <tr>
	<th align="right"><label for="url">Quelladresse</label></th>
	<td>
	  <input type="text" size="30" ng-model="settings.url" id="url" required ng-disabled="busy"> <button ng-click="get_veranstaltungen()" ng-disabled="busy">Liste abrufen</button>
	</td>
      </tr>
      <tr>
	<th align="right"><label for="tag">Veranstaltung</label></th>
	<td>
	  <select ng-model="remote.event" ng-options="event as veranstaltung_bezeichnung(event) for event in remote.events" ng-disabled="busy || !liste_abgerufen" id="tag">
	  </select>
	</td>
      </tr>
      <tr ng-if="remote.exists">
	<th align="right"></th>
	<td>
	  <input type="checkbox" ng-model="remote.replace" id="replace"><label for="replace">Vorhandene Veranstaltung ersetzen</label>
	</td>
      </tr>
      <tr>
	<th align="right"><label for="url"></label></th>
	<td>
	  <button ng-click="import_remote()" ng-disabled="!(liste_abgerufen && remote.event) || busy">Importieren (vom Server)</button>
	</td>
      </tr>
    </tbody>
    <tbody ng-if="settings.operation == 'sync'">
      <tr>
	<th align="right"><label for="url">Zieladresse</label></th>
	<td>
	  <input type="text" size="30" ng-model="settings.url" id="url" required>
	</td>
      </tr>
      <tr>
	<th align="right"><label for="timeout">Intervall</label></th>
	<td>
	  <input type="text" numeric min="1" max="600" size="3" ng-model="settings.timeout" id="timeout" style="text-align:center" required> Sekunden
	</td>
      </tr>
      <tr>
	<th align="right"></th>
	<td>
	  <button ng-click="synchronize()" ng-disabled="!form.$valid">Synchronisieren (zum Server)</button>
	</td>
      </tr>
    </tbody>
    <tbody ng-if="settings.operation == 'import-file' && settings.format == 'trialinfo'">
      <tr>
	<th align="right"><label for="filename">tra-Datei</label></th>
	<td>
	  <input type="file" id="filename" ng-disabled="busy" ng-model="settings.filename">
	</td>
      </tr>
      <tr>
	<th align="right"></th>
	<td>
	  <button ng-click="import_file()" ng-disabled="busy || !form.$valid">Importieren</button>
	</td>
      </tr>
    </tbody>
    <tbody ng-if="settings.operation == 'import-file' && settings.format == 'trialtool'">
      <tr>
	<th align="right"><label for="cfg_datei">cfg-Datei</label></th>
	<td>
	  <input type="file" id="cfg_datei" ng-disabled="busy" ng-model="settings.cfg_datei">
	</td>
      </tr>
      <tr>
	<th align="right"><label for="dat_datei">dat-Datei</label></th>
	<td>
	  <input type="file" id="dat_datei" ng-disabled="busy" ng-model="settings.dat_datei">
	</td>
      </tr>
      <tr>
	<th align="right"></th>
	<td>
	  <button ng-click="import_file()" ng-disabled="busy || !form.$valid">Importieren</button>
	</td>
      </tr>
    </tbody>
  </table>
</form>
